SELECT 
        	VENDEDORES.KUNNR AS VENDEDOR,
        	VENDEDORES.KTOKD,
        VENDEDORES.NAME1 AS NOMBRE_VENDEDOR,
        CLIENT_LOOKUP.VKORG AS SOCIEDAD_CLIENTE,
        CLIENTE.KUNNR AS CLIENTE,
        CLIENTE.NAME1 AS NOMBRE_CLIENTE,
        CLIENTE.STCD1 AS RUT_CLIENTE,
        CLIENTE.KTOKD AS TIPO_CLIENTE,
        CLIENT_LOOKUP.KUNN2 AS CLIENTE_ID,
        DESCRIPCION_GRUPO.GRUPO AS GRUPO,
        DESCRIPCION_GRUPO.NOMBRE AS NOMBRE_GRUPO,
        VENTAS.NETO_USD AS NETO_USD,
        TO_DATE(VENTAS.FKDAT, 'YYYYMMDD') AS FECHA_VENTA,
        EXTRACT (YEAR FROM TO_DATE(VENTAS.FKDAT, 'YYYYMMDD')) AS YEAR,
        EXTRACT (MONTH FROM TO_DATE(VENTAS.FKDAT, 'YYYYMMDD')) AS MONTH
    FROM
        NSAGRO64.KNA1 AS CLIENTE
    INNER JOIN
        NSAGRO64.KNVP AS CLIENT_LOOKUP
    ON CLIENTE.KUNNR = CLIENT_LOOKUP.KUNNR
    INNER JOIN
        NSAGRO64.KNVP AS VENDEDOR_LOOKUP
    ON CLIENTE.KUNNR = VENDEDOR_LOOKUP.KUNNR
    INNER JOIN
        NSAGRO64.KNA1 AS VENDEDORES
    ON VENDEDOR_LOOKUP.KUNN2 = VENDEDORES.KUNNR
    LEFT JOIN
        NSAGRO64."ServiceNS.services.sd.forecast.data::fc_grupod" as GRUPO
    ON CLIENTE.STCD1 = GRUPO.RUT
    LEFT JOIN
        NSAGRO64."ServiceNS.services.sd.forecast.data::fc_grupo" as DESCRIPCION_GRUPO
    ON GRUPO.GRUPO = DESCRIPCION_GRUPO.GRUPO
    LEFT JOIN
        NSAGRO64.ZSD010T1 AS VENTAS
    ON
        CLIENTE.KUNNR = VENTAS.KUNWE
    LEFT JOIN 
        NSAGRO64.ZSCP_EX_WERKS AS EXCLUSION_WERKS
    ON VENTAS.WERKS = EXCLUSION_WERKS.WERKS
    LEFT JOIN 
        NSAGRO64.ZSCP_EX_FKART AS EXCLUSION_FKART
    ON VENTAS.FKART = EXCLUSION_FKART.FKART
    WHERE GRUPO.GRUPO = '12000212'
    AND CLIENTE.STCD1 = '77700710-6'
    AND  CLIENT_LOOKUP.VKORG != '1200'
    AND  CLIENT_LOOKUP.PARVW = 'AG'
    AND(
            VENTAS.VKORG = CLIENT_LOOKUP.VKORG OR
            VENTAS.VKORG is null
        )
    AND VENDEDOR_LOOKUP.PARVW = 'VE' AND
        (
            VENTAS.VKORG = EXCLUSION_WERKS.BUKRS OR 
            EXCLUSION_WERKS.BUKRS IS NULL
        )
    AND (
	        VENTAS.VKORG = EXCLUSION_FKART.BUKRS OR 
	        EXCLUSION_FKART.BUKRS IS NULL
        )
    AND VENTAS.EERR_NC != 'X' 
		